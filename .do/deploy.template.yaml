spec:
    name: padloc
    envs:
        - key: PL_EMAIL_BACKEND
          scope: RUN_TIME
          value: "console"
        - key: PL_DATA_BACKEND
          scope: RUN_TIME
          value: "leveldb"
        - key: PL_ATTACHMENTS_BACKEND
          scope: RUN_TIME
          value: "fs"
        - key: PL_SERVER_URL
          scope: RUN_TIME
          value: ${server.PUBLIC_URL}
        - key: PL_PWA_URL
          scope: RUN_TIME
          value: ${pwa.PUBLIC_URL}
        - key: PL_PWA_DISABLE_CSP
          scope: BUILD_TIME
          value: "true"
        - key: PL_SERVER_URL
          scope: BUILD_TIME
          value: ${server.PUBLIC_URL}
        - key: PL_PWA_URL
          scope: BUILD_TIME
          value: ${pwa.PUBLIC_URL}
    services:
        - build_command: npm ci
          environment_slug: node-js
          git:
              branch: main
              repo_clone_url: "https://github.com/padloc/padloc"
          http_port: 3000
          instance_count: 1
          instance_size_slug: basic-xs
          name: server
          routes:
              - path: /server
          health_check:
              http_path: /healthcheck
          run_command: cd packages/server && npm start
          source_dir: /
    static_sites:
        - build_command: npm ci && cd packages/pwa && npm run build
          catchall_document: index.html
          environment_slug: node-js
          git:
              branch: main
              repo_clone_url: "https://github.com/padloc/padloc"
          name: pwa
          output_dir: packages/pwa/dist
          routes:
              - path: /
          source_dir: /
